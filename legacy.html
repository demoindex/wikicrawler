
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>recentchange legacy</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Helvetica,Arial,sans-serif;
}

.ui{
  background:#111;
  padding:6px;
  text-align:center;
}

button{
  background:#222;
  color:#fff;
  border:1px solid #000;
  padding:6px 8px;
  font-size:12px;
  margin:2px;
}

#grid{
  width:100%;
}

.tile{
  width:25%;
  padding-bottom:25%;
  float:left;
  background:#111;
  background-size:cover;
  background-position:center;
  position:relative;
}

.info{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  font-size:10px;
  background:rgba(0,0,0,0.6);
  padding:3px;
}

.clear{clear:both;}
</style>
</head>

<body>

<div class="ui">
recentchange â€“ legacy mode<br>
<button onclick="start()">START</button>
<button onclick="stop()">STOP</button>
</div>

<div id="grid"></div>
<div class="clear"></div>

<script>
var grid=document.getElementById("grid");
var timer=null;

function addTile(title,img){
  var d=document.createElement("div");
  d.className="tile";
  d.style.backgroundImage="url("+img+")";

  var i=document.createElement("div");
  i.className="info";
  i.innerHTML=title;

  d.appendChild(i);

  if(grid.childNodes.length>40){
    grid.removeChild(grid.lastChild);
  }

  if(grid.firstChild){
    grid.insertBefore(d,grid.firstChild);
  }else{
    grid.appendChild(d);
  }
}

function randomTile(){
  var r=new XMLHttpRequest();
  var url="https://en.wikipedia.org/api/rest_v1/page/random/summary";

  r.onreadystatechange=function(){
    if(r.readyState==4 && r.status==200){
      try{
        var d=JSON.parse(r.responseText);
        if(d.thumbnail){
          addTile(d.title,d.thumbnail.source);
        }
      }catch(e){}
    }
  };
  r.open("GET",url,true);
  r.send();
}

function start(){
  if(timer) return;
  timer=setInterval(randomTile,2000);
}

function stop(){
  clearInterval(timer);
  timer=null;
}
</script>

</body>
</html>
